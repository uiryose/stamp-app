{% extends 'layout.html' %}
{% block title %}景品一覧{% endblock %}
{% block content %}

      <div class="d-flex justify-content-between align-items-center mb-3">
        <h1 class="h4 m-0">景品一覧</h1>
        <div class="text-muted">保有スタンプ: <strong>{{ user.stamps }}</strong></div>
      </div>

      <div class="row g-3">
        {% for r in rewards %}
          <div class="col-md-6">
            <div class="card h-100 shadow-sm">
              <div class="card-body d-flex flex-column">
                <h5 class="card-title">{{ r.name }}</h5>
                <p class="card-text">必要スタンプ: <strong>{{ r.required_stamps }}</strong></p>
                <div class="mt-auto d-flex justify-content-end">
                  {% if user.stamps >= r.required_stamps %}
                    <form method="post" action="{{ url_for('request_reward', reward_id=r.id) }}" class="m-0 p-0">
                      <button class="btn btn-primary" type="submit">交換申請</button>
                    </form>
                  {% else %}
                    <button class="btn btn-secondary" disabled>スタンプ不足</button>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        {% else %}
          <div class="col-12">
            <div class="alert alert-info">景品がありません</div>
          </div>
        {% endfor %}
      </div>

      <div class="mt-4">
        <h2 class="h6">最近の申請</h2>
        <ul class="list-group">
          {% for req in recent_requests %}
            <li class="list-group-item d-flex justify-content-between align-items-center">
              <span>{{ req.reward.name }}</span>
              <span class="badge bg-secondary">{{ req.status }}</span>
            </li>
          {% else %}
            <li class="list-group-item text-muted">申請履歴はありません</li>
          {% endfor %}
        </ul>
      </div>
{% endblock %}


